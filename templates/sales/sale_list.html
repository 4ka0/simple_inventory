{% extends 'base.html' %}
{% load humanize %}

{% block page-trail %}&nbsp;&nbsp;>&nbsp;&nbsp;All Sales{% endblock page-trail %}

{% block content %}

    <div class="row my-5 mx-3">

        <div class="col mx-3">

            <!-- 販売情報がある場合、在庫のテーブルを表示する -->

            {% if sales %}

            <h6 class="mb-4"><i>*All sales are listed in reverse chronological order, i.e. most recent first.</i></h6>

            <div class="table-responsive">

                <table class="table table-bordered">

                    <thead class="table-header-bg-2">
                        <tr>
                            <th scope="col">Fruit</th>
                            <th scope="col">Quantity</th>
                            <th scope="col">Proceeds (¥)</th>
                            <th scope="col">Sale Date & Time</th>
                            <th scope="col" class="col-center-align">Actions</th>
                        </tr>
                    </thead>

                    <tbody class="table-body-bg">

                        {% for sale in sales %}

                            <tr>
                                <td>{{ sale.fruit_name|capfirst }}</td>
                                <td>{{ sale.quantity|intcomma }}</td>
                                <td>{{ sale.proceeds|intcomma }}</td>
                                <td>{{ sale.sold_on|date:"Y-m-d" }}, {{ sale.sold_on|time:"H:i" }}</td>
                                <td class="col-center-align">
                                    <!-- 編集バトン -->
                                    <a href="{% url 'sale_update' sale.pk %}"  class="btn btn-outline-primary btn-sm mr-2" role="button">Update</a>

                                    &nbsp;

                                    <!-- 削除バトン -->
                                    <form action="{% url 'sale_delete' sale.pk %}" method="POST" style="display:inline">
                                        {% csrf_token %}
                                        <button type="submit" class="btn btn-outline-danger btn-sm">Delete</button>
                                    </form>

                                </td>
                            </tr>

                        {% endfor %}

                    </tbody>

                </table>

            </div>

            <!-- 新規追加とCSVファイルアップロードのボタン -->
            <div class="text-center">
                <a href="{% url 'sale_create' %}" class="btn btn-primary mr-2" role="button">Add New Sale</a>
                &nbsp;
                <a href="{% url 'sale_upload' %}" class="btn btn-primary" role="button">Batch Upload</a>
            </div>

            <!-- 販売情報がない場合、通知を表示する -->

            {% else %}

                <p>No sales information has been added. To do so, please use one of the buttons below.</p>
                <a href="{% url 'sale_create' %}" class="btn btn-primary mt-3 mr-2" role="button">Add New Sale</a>
                &nbsp;
                <a href="{% url 'sale_upload' %}" class="btn btn-primary mt-3" role="button">Batch Upload</a>

            {% endif %}

        </div>

    </div>

{% endblock %}